(function(a,b){var c=b(a);if(typeof define==="function"&&define.amd){define([],b)}else if(typeof module!=="undefined"&&module.exports){module.exports=b()}else{a.ws=b()}})(this,function(a,b){if(!("WebSocket"in window))return;var c={},d,e=document.createElement("div"),f={automaticOpen:true,reconnectDecay:1.5},g=function(){},h={CONNECTING:WebSocket.CONNECTING,OPEN:WebSocket.OPEN,CLOSING:WebSocket.CLOSING,CLOSED:WebSocket.CLOSED};function i(a,b,c){var d=this;this.url=a;this.readyState=WebSocket.CONNECTING;this.protocol=b?b:null;if(!c){c={}}for(var g in f){if(typeof c[g]!=="undefined")this[g]=c[g];else this[g]=f[g]}for(var i in h)this[i]=h[i];e.addEventListener("open",function(a){d.onopen(a)});e.addEventListener("close",function(a){d.onclose(a)});e.addEventListener("connecting",function(a){d.onconnecting(a)});e.addEventListener("message",function(a){d.onmessage(a)});e.addEventListener("error",function(a){d.onerror(a)});this.addEventListener=e.addEventListener.bind(e);this.removeEventListener=e.removeEventListener.bind(e);this.dispatchEvent=e.dispatchEvent.bind(e);if(this.automaticOpen===true)this.open();return this}function j(a,b){var c=document.createEvent("CustomEvent");c.initCustomEvent(a,false,false,b);return c}i.prototype.onconnecting=g;i.prototype.onerror=g;i.prototype.onopen=g;i.prototype.onmessage=g;i.prototype.send=function(a){if(this.wsocket)this.wsocket.send(a);else{throw"INVALID_STATE_ERR : Pausing to reconnect websocket"}};i.prototype.close=function(a,b){if(typeof a==="undefined")a=1e3;if(this.wsocket)this.wsocket.close(a,b)};i.prototype.open=function(){var a=this;d=new WebSocket(this.url,this.protocol||[]);e.dispatchEvent(j("connecting"));d.onopen=function(b){a.protocol=i.protocol;a.readyState=WebSocket.OPEN;var c=j("open");e.dispatchEvent(c)};d.onclose=function(b){a.readyState=WebSocket.CLOSED;var c=j("connecting");c.code=b.code;c.reason=b.reason;c.wasClean=b.wasClean;e.dispatchEvent(c);e.dispatchEvent(j("close"))};d.onmessage=function(a){var b=j("message");b.data=a.data;e.dispatchEvent(b)};d.onerror=function(a){var b=j("error");e.dispatchEvent(b)};this.wsocket=d;return this};return i});